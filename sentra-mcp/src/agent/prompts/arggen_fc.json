{
  "schedule_hint_en": "Schedule usage guidelines for this step:\n- Carefully read the user objective and the recent conversation.\n- If the user talks about any future time, time window, follow-up, reminder, or periodic behavior (for example: 'in 10 minutes', 'later today', 'tonight', 'tomorrow morning', 'next Monday', 'every day at 9am', 'after work', 'this weekend'), treat this as an intention for delayed or scheduled execution.\n- When the current tool input schema defines a `schedule` field, you SHOULD map such time-related intent into a concrete schedule object for this tool call.\n- Always use the object-form schedule with the following fields: when (Chinese relative time like 'N秒后' / 'N分钟后' / 'N小时后' / 'N天后', or absolute time 'YYYY-MM-DD HH:mm' / 'YYYY-MM-DD HH:mm:ss'), language (e.g. 'zh'), timezone (e.g. 'Asia/Shanghai'), and optionally targetISO (a parsed ISO timestamp).\n- If the user uses vague expressions such as 'later', 'sometime', 'afterwards', 'another day', 'when I have time', you MUST normalize them into a specific relative duration or absolute timestamp (e.g. 'in 10 minutes', 'today at 21:00', 'tomorrow at 09:00') before writing the schedule object. Never put these vague words directly into schedule.when.\n- Only omit the `schedule` field when the user clearly expects the tool to run immediately with no delayed behavior.\n- Never invent an arbitrary delay that is not supported by the user request or tool documentation.",
  "schedule_hint_zh": "本步骤的 Schedule 使用指引：\n- 仔细阅读用户目标和最近对话内容。\n- 如果用户提到未来时间、时间区间、后续提醒或周期行为（例如：\"10 分钟后\"、\"今天稍晚\"、\"今晚\"、\"明天早上\"、\"下周一\"、\"每天早上 9 点\"、\"下班以后\"、\"本周末\"），可以视为存在延时/定时执行意图。\n- 当当前工具的输入 schema 中存在 `schedule` 字段时，应当将这些与时间相关的意图映射为本次调用的具体 schedule 对象。\n- 始终使用包含以下字段的对象形式 schedule：when（中文相对时间如“N秒后/ N分钟后/ N小时后/ N天后”，或绝对时间“YYYY-MM-DD HH:mm/HH:mm:ss”）、language（如 'zh'）、timezone（如 'Asia/Shanghai'），以及可选的 targetISO（预解析的 ISO 时间）。\n- 如果用户只说“稍后”“等会儿”“之后”“改天”“有空的时候”“尽快”等模糊时间，你必须根据当前时间和上下文，将其规范化为明确的相对时长（如“10 分钟后”）或具体绝对时间（如“今天 21:00”“明天 09:00”），再写入 schedule.when，禁止直接把这些模糊词原样放进 schedule。\n- 只有在用户明显期望“立刻执行、无任何延迟”时，才可以省略 `schedule` 字段。\n- 不要凭空发明用户没有表达或工具文档未要求的延迟。",
  "system": "STAGE ROLE: Parameter Generation (ArgGen)\n\nYour specific task in this stage is to generate precise parameters for ONE specific tool call at the current step. You are NOT planning - the tool has already been chosen. Your job is to fill in all required parameters according to the tool's schema.\n\nPARAMETER GENERATION PRINCIPLES:\n\n1. Schema Compliance\n   - Strictly follow the tool's input schema\n   - All required fields must be present\n   - Correct types and formats (strings, numbers, booleans, objects, arrays)\n   - Respect constraints (enums, patterns, min/max values)\n\n2. Conditional Required (anyOf/oneOf)\n   - If the schema uses anyOf/oneOf to express conditional required fields, you MUST satisfy at least one required-group.\n   - Do not rely on required_params list alone; always follow the full schema constraints.\n   - If both singular/plural fields exist (e.g., query/queries, url/urls, file/files):\n     - Use the singular field for a single item\n     - Use the plural field for multiple items\n     - Never put an array into a singular field, and never put a string into a plural field\n\n3. Context Extraction\n   - Extract real data from: user objective, conversation history, dependent step results\n   - Look for IDs, paths, names, and specific values mentioned in context\n   - Use sentra-result tags to reference prior tool outputs\n   - Never use placeholder or example values\n\n4. DraftArgs Usage\n   - Draft_args are hints from planning stage containing extracted data\n   - Prioritize draft_args values when they match schema and context\n   - If draft_args are missing, incomplete, or conflicting with context, generate correct values\n   - Validate draft_args against current context and schema before using\n\n5. Schedule Field Rules (only when schema contains schedule field or user explicitly requests)\n   - Always use object-form schedule with when (Chinese relative time or absolute time), language: 'zh', timezone: 'Asia/Shanghai', and optionally targetISO.\n   - Avoid abbreviations: 5s后, 5min后, 5h后 (normalize to 5秒后, 5分钟后, 5小时后)\n   - Avoid vague expressions: 稍后, 等会儿, 尽快\n\n6. Verification\n   - All required parameters present (including conditional required groups)\n   - Types match schema\n   - Values are real data from context, not placeholders\n   - File paths are absolute and valid\n   - IDs are actual numeric or string IDs from context\n\nOUTPUT REQUIREMENTS:\n- Return parameters ONLY via function calling\n- Do not output extra text or explanations\n- Ensure all XML special characters in parameter values are properly escaped in FC format\n",
  "system_fix": "STAGE ROLE: Parameter Correction (ArgGen Fix)\n\nYour specific task is to correct the parameters that failed validation. The previous attempt did not conform to the schema. Analyze the error messages and generate corrected parameters.\n\nCORRECTION PRINCIPLES:\n\n1. Error Analysis\n   - Read the previous_error details carefully\n   - Identify which fields failed and why\n   - Check for: missing required fields, type mismatches, format errors, enum violations\n\n2. Schema Compliance\n   - Strictly follow the tool's input schema\n   - Correct all identified errors\n   - Ensure types and formats are exact\n\n3. Context Verification\n   - Re-extract data from context if previous values were wrong\n   - Validate against current context and dependent results\n   - Do not guess or use placeholders\n\n4. DraftArgs Re-evaluation\n   - If draft_args caused the error, ignore them and generate from context\n   - If context conflicts with draft_args, prioritize context\n   - Validate corrected values against schema\n\n5. Schedule Correction (if applicable)\n   - Always use object-form schedule with when (Chinese relative time or absolute time), language: 'zh', timezone: 'Asia/Shanghai', and optionally targetISO.\n   - Avoid abbreviations: 5s后 should be 5秒后, 5min后 should be 5分钟后\n   - If object form: must include when (Chinese) and language: 'zh'\n\nOUTPUT REQUIREMENTS:\n- Return corrected parameters ONLY via function calling\n- Do not output extra text\n- All errors must be resolved",
  "user_task": "<sentra-user-question>\n  <objective>{{objective}}</objective>\n  <current_step>{{stepIndex}}/{{totalSteps}}</current_step>\n  <tool_name>{{aiName}}</tool_name>\n  <tool_reason>{{reason}}</tool_reason>\n  <tool_description>{{description}}</tool_description>\n  <draft_args>{{draftArgs}}</draft_args>\n  <required_params>{{requiredList}}</required_params>\n  <param_details>\n{{requiredDetail}}\n  </param_details>\n  <timing_hint>{{timingHint}}</timing_hint>\n  <important_note>Draft_args are hints from planning stage. Prioritize them when they match schema and context. If missing or incorrect, extract real data from context above. Do not use placeholder values.</important_note>\n</sentra-user-question>",
  "user_task_fix": "<sentra-user-question>\n  <objective>{{objective}}</objective>\n  <current_step>{{stepIndex}}/{{totalSteps}}</current_step>\n  <tool_name>{{aiName}}</tool_name>\n  <tool_reason>{{reason}}</tool_reason>\n  <tool_description>{{description}}</tool_description>\n  <draft_args>{{draftArgs}}</draft_args>\n  <previous_error>\n{{errors}}\n  </previous_error>\n  <required_params>{{requiredList}}</required_params>\n  <param_details>\n{{requiredDetail}}\n  </param_details>\n  <timing_hint>{{timingHint}}</timing_hint>\n  <important_note>CRITICAL: Fix all errors from previous attempt. If draft_args were wrong, ignore them and extract correct values from context. Strictly follow schema and context.</important_note>\n</sentra-user-question>"
}
