{
  "zh": "产出计划（FC 模式，Sentra XML 协议）\n\n请仅输出且仅输出一个工具调用块，**必须**使用 Sentra XML 协议的 typed 参数格式：\n\n```xml\n<sentra-tools>\n  <invoke name=\"emit_plan\">\n    <parameter name=\"overview\">\n      <string>任务的总体目标与高层策略概要</string>\n    </parameter>\n    <parameter name=\"steps\">\n      <array>\n        <object>\n          <parameter name=\"stepId\"><string>s_example_step_0</string></parameter>\n          <parameter name=\"aiName\"><string>local__search</string></parameter>\n          <parameter name=\"reason\">\n            <array>\n              <string>需要先检索相关信息</string>\n            </array>\n          </parameter>\n          <parameter name=\"nextStep\"><string>基于检索结果选择后续操作</string></parameter>\n          <parameter name=\"draftArgs\">\n            <object>\n              <parameter name=\"query\"><string>用户查询关键词</string></parameter>\n              <parameter name=\"max_results\"><number>5</number></parameter>\n            </object>\n          </parameter>\n          <parameter name=\"dependsOnStepIds\">\n            <array>\n              <string>s_example_step_0</string>\n            </array>\n          </parameter>\n        </object>\n        <!-- 如有更多步骤，继续添加 <object> ... </object> -->\n      </array>\n    </parameter>\n  </invoke>\n</sentra-tools>\n```\n\n**严格格式要求：**\n1. 整体必须包裹在 `<sentra-tools>` 块中，内部只包含一个 `<invoke name=\"emit_plan\">`。\n2. `overview` 参数：\n   - XML 结构：`<parameter name=\"overview\"><string>...</string></parameter>`。\n   - 类型：string，可选。简要描述本次任务的整体目标与执行策略（而不是逐步步骤）。\n3. `steps` 参数：\n   - XML 结构：\n     ```xml\n     <parameter name=\"steps\">\n       <array>\n         <object>...单个步骤对象...</object>\n         <object>...下一个步骤对象...</object>\n       </array>\n     </parameter>\n     ```\n   - 类型：array（在 XML 中用 `<array>` 表示），必填。数组中的每一项都是一个 `<object>` 步骤对象。\n\n每个步骤对象的 XML 结构必须完全遵守：\n- `aiName`：\n  - 结构：`<parameter name=\"aiName\"><string>工具名称</string></parameter>`\n  - 类型：string，必须从允许列表 {{allowed_list}} 中选择，禁止发明列表外的工具名。\n- `reason`：\n  - 结构：\n    ```xml\n    <parameter name=\"reason\">\n      <array>\n        <string>调用该工具的理由 1</string>\n        <string>调用该工具的理由 2</string>\n      </array>\n    </parameter>\n    ```\n  - 类型：string[]，必填。数组中每一项是调用该 operation 的简短理由。\n- `nextStep`：\n  - 结构：`<parameter name=\"nextStep\"><string>本步骤完成后如何利用结果</string></parameter>`\n  - 类型：string，必填。明确说明当前步骤执行完后，下一步如何利用本步骤的结果。\n- `draftArgs`：\n  - 结构：\n    ```xml\n    <parameter name=\"draftArgs\">\n      <object>\n        <parameter name=\"字段名1\">VALUE1</parameter>\n        <parameter name=\"字段名2\">VALUE2</parameter>\n      </object>\n    </parameter>\n    ```\n  - 类型：object，必填。该步骤计划传入给工具的参数草案：\n    - 只填写该工具 inputSchema.required 中的必填字段，不要加入无关字段。\n    - 对于数组类型字段（例如 `cities`、`queries`、`keywords` 等），应将多个同类目标合并到一次调用中，通过数组参数批量执行，而不是拆成多个几乎相同的步骤。\n- `dependsOnStepIds`：\n  - 结构：\n    ```xml\n    <parameter name=\"dependsOnStepIds\">\n      <array>\n        <string>s_prev_0</string>\n        <string>s_prev_1</string>\n      </array>\n    </parameter>\n    ```\n  - 类型：string[]，可选。数组中每个元素是本步骤依赖的前置 stepId。\n\n**值类型与结构规范（Sentra XML typed nodes）**\n在 `<sentra-tools>` 中，所有参数值必须用 typed 节点表示，不能直接塞 JSON 文本：\n- `<string>...</string>`：字符串（任意文本，保留空格、换行和特殊字符）。\n- `<number>...</number>`：数字（整数或小数）。\n- `<boolean>true/false</boolean>`：布尔值。\n- `<null></null>`：空值。\n- `<array>...</array>`：数组；其直接子节点只能是 `string/number/boolean/null/array/object` 六种类型之一。\n- `<object>...</object>`：对象；其内容**只能**由 `<parameter name=\"字段名\">VALUE</parameter>` 组成，其中 VALUE 必须是上述六种类型之一。\n\n**常见错误（必须避免）：**\n1. 在 `steps` 中直接输出 JSON 文本：\n   - 错误示例：`<parameter name=\"steps\">[{\\\"aiName\\\": \\\"tool\\\"}]</parameter>`\n   - 正确做法：使用 `<array>`+`<object>`+`<parameter>` 的结构。\n2. 发明自定义标签表示对象或键名，例如：\n   - `<key>aiName</key><string>...</string>`\n   - `<item>...</item>`\n   - `<aiName>...</aiName>`（没有 `<parameter name=\"aiName\">` 包裹）\n   - `<field name=\"aiName\">...</field>`\n   以上写法全部禁止，解析器不会识别。\n3. 在 `<array>` 中混入除 `string/number/boolean/null/array/object` 以外的标签。\n4. 在 `<sentra-tools>` 中不进行 XML 转义，直接输出 `<`、`>`、`&`、`\"`、`'`：\n   - 正确：`<string>&lt;div class=\"card\"&gt;内容&lt;/div&gt;</string>`\n   - 错误：`<string><div class=\"card\">内容</div></string>`（会破坏 XML 结构）。\n\n**计划质量与调度（Schedule）指引：**\n- 工具选择：\n  - 只能从允许列表 {{allowed_list}} 中选择 aiName，视为封闭集合（closed world）。\n  - 如确无合适工具，可输出空 steps 数组，但严禁发明、猜测或自由创建列表外 operation。\n- 步骤设计：\n  - 每个步骤仅使用一个工具（一个 aiName）。\n  - `reason` 要清晰说明为什么需要此步骤，以及它与整体目标的关系。\n  - `nextStep` 要说明当前步骤的结果将如何影响后续步骤。\n  - 优先通过数组参数（如 `cities`、`queries`、`keywords`）合并多个同类目标，避免堆叠大量几乎相同的步骤。\n- Schedule 规划（仅当工具 schema 中存在 schedule 字段或用户明确要求时）：\n  - 支持的时间表达：\n    - 中文相对时间：`N秒后`、`N分钟后`、`N小时后`、`N天后`（使用阿拉伯数字）。\n    - 绝对时间：`YYYY-MM-DD HH:mm` 或 `YYYY-MM-DD HH:mm:ss`（默认时区 Asia/Shanghai）。\n  - 避免含糊表达：如“稍后”“等会儿”“尽快”，应转换为明确的时间。\n  - 不要凭空添加用户未表达的延迟。\n\n**输出规则：**\n- 仅输出一个 `<sentra-tools>` 块，不要包含任何解释性自然语言、Markdown 或注释。\n- 严格遵守上述 XML 结构与类型约束，以便服务器使用 fast-xml-parser 和 schema 校验顺利解析。\n\n\n补充约束（依赖与标识）：\n- 每个 step 对象必须包含 stepId（string，且在同一计划内唯一）。\n- 只能使用 dependsOnStepIds（string[]）表示依赖，且只能引用前序步骤的 stepId。\n- 不要输出任何基于索引的依赖字段。",
  "en": "PLAN GENERATION (FC mode, Sentra XML Protocol)\n\nYou MUST output ONE AND ONLY ONE tool call block using the Sentra XML Protocol with **typed** parameter values:\n\n```xml\n<sentra-tools>\n  <invoke name=\"emit_plan\">\n    <parameter name=\"overview\">\n      <string>High-level objective and strategy for the task</string>\n    </parameter>\n    <parameter name=\"steps\">\n      <array>\n        <object>\n          <parameter name=\"stepId\"><string>s_example_step_0</string></parameter>\n          <parameter name=\"aiName\"><string>local__search</string></parameter>\n          <parameter name=\"reason\">\n            <array>\n              <string>First, search for relevant information</string>\n            </array>\n          </parameter>\n          <parameter name=\"nextStep\"><string>Use the search results to decide the next actions</string></parameter>\n          <parameter name=\"draftArgs\">\n            <object>\n              <parameter name=\"query\"><string>keywords from the user request</string></parameter>\n              <parameter name=\"max_results\"><number>5</number></parameter>\n            </object>\n          </parameter>\n          <parameter name=\"dependsOnStepIds\">\n            <array>\n              <string>s_example_step_0</string>\n            </array>\n          </parameter>\n        </object>\n        <!-- Add more <object>...</object> for additional steps if needed -->\n      </array>\n    </parameter>\n  </invoke>\n</sentra-tools>\n```\n\n**STRICT STRUCTURAL REQUIREMENTS:**\n1. The entire output MUST be wrapped in a single `<sentra-tools>` block containing exactly one `<invoke name=\"emit_plan\">`.\n2. `overview` parameter:\n   - XML structure: `<parameter name=\"overview\"><string>...</string></parameter>`.\n   - Type: string, optional. Provide a brief high-level objective and strategy for the run (NOT a step-by-step list).\n3. `steps` parameter:\n   - XML structure:\n     ```xml\n     <parameter name=\"steps\">\n       <array>\n         <object>...single step object...</object>\n         <object>...next step object...</object>\n       </array>\n     </parameter>\n     ```\n   - Type: array (represented by `<array>` in XML), REQUIRED. Each item in the array MUST be one `<object>` step.\n\nEach step object MUST strictly follow this XML structure:\n- `aiName`:\n  - Structure: `<parameter name=\"aiName\"><string>TOOL_NAME</string></parameter>`\n  - Type: string. MUST be chosen from {{allowed_list}}. You MUST NOT invent tool names outside this list.\n- `reason`:\n  - Structure:\n    ```xml\n    <parameter name=\"reason\">\n      <array>\n        <string>short justification 1</string>\n        <string>short justification 2</string>\n      </array>\n    </parameter>\n    ```\n  - Type: string[], REQUIRED. Each string is a short reason for calling this operation.\n- `nextStep`:\n  - Structure: `<parameter name=\"nextStep\"><string>how this step feeds into later steps</string></parameter>`\n  - Type: string, REQUIRED. Clearly explains how the result of this step will be used later.\n- `draftArgs`:\n  - Structure:\n    ```xml\n    <parameter name=\"draftArgs\">\n      <object>\n        <parameter name=\"FIELD_1\">VALUE1</parameter>\n        <parameter name=\"FIELD_2\">VALUE2</parameter>\n      </object>\n    </parameter>\n    ```\n  - Type: object, REQUIRED. Planned arguments for this tool call:\n    - Only include required fields from the tool's input schema (`inputSchema.required`).\n    - Do NOT add irrelevant fields.\n    - When the tool exposes array-typed fields (e.g., `cities`, `queries`, `keywords`), you SHOULD merge multiple similar targets into a single call with an array, instead of creating many nearly identical steps.\n- `dependsOnStepIds`:\n  - Structure:\n    ```xml\n    <parameter name=\"dependsOnStepIds\">\n      <array>\n        <string>s_prev_0</string>\n        <string>s_prev_1</string>\n      </array>\n    </parameter>\n    ```\n  - Type: string[], optional. Each item is a stepId of a previous step this step depends on.\n\n**VALUE TYPE & STRUCTURE (Sentra XML typed nodes)**\nInside `<sentra-tools>`, ALL parameter values MUST be expressed using typed value nodes. You MUST NOT embed raw JSON objects/arrays directly in `<parameter>` bodies. Allowed value nodes:\n- `<string>...</string>`: string (arbitrary text; keep spaces, newlines, and special chars).\n- `<number>...</number>`: numeric value (integer or float).\n- `<boolean>true/false</boolean>`: boolean.\n- `<null></null>`: null.\n- `<array>...</array>`: array; its direct children MUST be one of `string/number/boolean/null/array/object`.\n- `<object>...</object>`: object; its content MUST consist ONLY of `<parameter name=\"field\">VALUE</parameter>` elements, where VALUE is one of the six node types above.\n\n**COMMON MISTAKES TO AVOID:**\n1. Embedding raw JSON for `steps` or other fields:\n   - WRONG: `<parameter name=\"steps\">[{\\\"aiName\\\": \\\"tool\\\"}]</parameter>`\n   - CORRECT: use `<array>` + `<object>` + `<parameter>` as shown above.\n2. Inventing custom XML tags to represent keys or items, such as:\n   - `<key>aiName</key><string>...</string>`\n   - `<item>...</item>`\n   - `<aiName>...</aiName>` without a `<parameter name=\"aiName\">` wrapper\n   - `<field name=\"aiName\">...</field>`\n   These forms are FORBIDDEN and will NOT be parsed.\n3. Mixing unsupported tags inside `<array>`, other than `string/number/boolean/null/array/object`.\n4. Failing to XML-escape special characters inside `<string>` when building the XML:\n   - CORRECT: `<string>&lt;div class=\"card\"&gt;content&lt;/div&gt;</string>`\n   - WRONG: `<string><div class=\"card\">content</div></string>` (breaks XML and cannot be parsed).\n\n**PLAN QUALITY & SCHEDULING GUIDELINES:**\n- Tool selection:\n  - Treat {{allowed_list}} as a CLOSED set of valid `aiName` values.\n  - If truly no tool fits, you MAY return an empty `steps` array, but you MUST NOT invent operations outside the list.\n- Step design:\n  - Exactly one tool (`aiName`) per step.\n  - `reason` must clearly explain why this step is needed and how it supports the overall objective.\n  - `nextStep` must explain how this step's output will be used in later steps.\n  - Prefer batching via array-typed arguments (e.g., `cities`, `queries`, `keywords`) instead of many nearly identical steps.\n- Schedule planning (only when the tool schema has a `schedule` field or the user explicitly requests delayed execution):\n  - Supported time formats:\n    - Chinese relative time: `N秒后`, `N分钟后`, `N小时后`, `N天后` (use Arabic numerals).\n    - Absolute time: `YYYY-MM-DD HH:mm` or `YYYY-MM-DD HH:mm:ss` (default timezone: Asia/Shanghai).\n  - Avoid vague expressions like \"later\", \"soon\", \"sometime\"; convert them into precise, parseable times when possible.\n  - Never invent delays that are not grounded in the user request or tool documentation.\n\n**OUTPUT RULES:**\n- Output ONLY the `<sentra-tools>` block, with a single `<invoke name=\"emit_plan\">`.\n- DO NOT output natural language explanations, Markdown, or comments outside the XML block.\n- Strictly follow the XML structure and typed value rules above so that the server can parse your plan with fast-xml-parser and validate it against the emit_plan schema.\n\n\nAdditional constraints (identity & dependencies):\n- Each step object MUST include stepId (string, unique within the plan).\n- Dependencies MUST use dependsOnStepIds (string[]), and MUST only reference stepIds of earlier steps.\n- Do NOT output any index-based dependency fields."
}
